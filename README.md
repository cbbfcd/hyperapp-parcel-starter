# ğŸš€ hyperapp åˆ†æ

> 1 kB JavaScript micro-framework for building web applications -- [hyperapp](https://github.com/hyperapp/hyperapp)

æœ€å¸å¼•äººçš„å°±æ˜¯è¿™å¥ä»‹ç»äº†ã€‚

# ğŸ”¥ hyperapp æ–‡æ¡£

åŸæ–‡è§[å®˜æ–¹æ–‡æ¡£](https://github.com/hyperapp/hyperapp)

è¿™é‡Œæˆ‘ç®€å•çš„ä»‹ç»ä¸€ä¸‹ï¼š

* Minimal -- æˆ‘ä»¬ç§¯æåœ°å°†æ‚¨éœ€è¦ç†è§£çš„æ¦‚å¿µæœ€å°åŒ–ï¼Œä»¥æé«˜å·¥ä½œæ•ˆç‡ï¼ŒåŒæ—¶ä¿æŒä¸å…¶ä»–æ¡†æ¶ç›¸åŒçš„åŠŸèƒ½ã€‚
* Pragmatic -- åœ¨ç®¡ç†ä½ çš„çŠ¶æ€çš„æ—¶å€™å¯ä»¥é‡‡ç”¨åŠ¡å®çš„åŠæ³•ï¼Œå…è®¸å‰¯ä½œç”¨ã€å¼‚æ­¥æ“ä½œå’Œ DOM æ“ä½œã€‚
* Standalone -- åŒæ ·æ”¯æŒç‰›é€¼çš„ virtual DOM æ¥ç”¨æ›´å°çš„ä»£ä»·ç®¡ç†çŠ¶æ€ã€æ¸²æŸ“è§†å›¾ï¼Œæœ‰ç®€å•çš„ç”Ÿå‘½å‘¨æœŸå’ŒåŸºäº key æ ‡è¯†çš„èŠ‚ç‚¹æ›´æ–°

Hyperapp åªæœ‰ä¸¤ä¸ªæœ€é‡è¦çš„ API:

- h: ç”¨äºå¤„ç† viewï¼Œè¿”å› Virtual DOM èŠ‚ç‚¹
- app: ç”¨äºå°†ä¸€ä¸ªåº”ç”¨ç¨‹åºæŒ‚è½½åˆ°ç‰¹å®šçš„ DOM å…ƒç´ ä¸Šï¼Œä¹Ÿå¯ä»¥ä¸æŒ‡å®š DOM å…ƒç´ ï¼ˆè¿™å°†åˆ©äºæµ‹è¯•ï¼‰

## â¤ï¸ h

æ–‡æ¡£ä¸­ä½¿ç”¨äº† jsxï¼Œéœ€è¦å®‰è£…æ’ä»¶å°† jsx ç¼–è¯‘æˆ h å‡½æ•°èƒ½å¤Ÿå¤„ç†çš„æ ·å­ã€‚

```js
const view = (state, actions) =>
  h("div", {}, [
    h("h1", {}, state.count),
    h("button", { onclick: () => actions.down(1) }, "-"),
    h("button", { onclick: () => actions.up(1) }, "+")
  ])

// h å‡½æ•°å¤„ç†ä¹‹åå¾—åˆ°ä¸€ä¸ª v-DOM
{
  nodeName: "div",
  attributes: {},
  children: [
    {
      nodeName: "h1",
      attributes: {},
      children: [0]
    },
    {
      nodeName: "button",
      attributes: { ... },
      children: ["-"]
    },
    {
      nodeName:   "button",
      attributes: { ... },
      children: ["+"]
    }
  ]
}
```

äº‹å®ä¸Šå¹¶ä¸æ˜¯ä¸€å®šè¦ jsx çš„ï¼Œä½ ç›´æ¥å†™ h å‡½æ•°ç»“æ„ä¹Ÿèƒ½é¡ºåˆ©å¾—åˆ°ä¸€ä¸ª v-DOM ç»“æ„ã€‚ä¹Ÿå¯ä»¥ç”¨å…¶ä»–ä»»åŠ¡çš„è¯­æ³•æ¨¡ç‰ˆã€‚

## ğŸš´â€â™€ï¸ app

Hyperapp åº”ç”¨ç¨‹åºä¸»è¦çš„ä¸‰æ¿æ–§è¿˜æ˜¯ state, actions, viewã€‚React ç”¨æˆ·ä¼¼ä¹å¯¹è¿™ä¸ªå¾ˆç†Ÿæ‚‰...

åˆå§‹åŒ–åï¼Œæ‚¨çš„åº”ç”¨ç¨‹åºå°†åœ¨è¿ç»­å¾ªç¯ä¸­æ‰§è¡Œï¼Œä»ç”¨æˆ·æˆ–å¤–éƒ¨äº‹ä»¶æ¥æ”¶æ“ä½œï¼Œæ›´æ–°çŠ¶æ€ï¼Œå¹¶é€šè¿‡ v-DOM æ¨¡å‹è¡¨ç¤ºè§†å›¾ä¸­çš„æ›´æ”¹ã€‚ 
å°†æ“ä½œè§†ä¸ºé€šçŸ¥ Hyperapp æ›´æ–°çŠ¶æ€å¹¶å®‰æ’ä¸‹ä¸€ä¸ªè§†å›¾é‡ç»˜çš„ä¿¡å·ã€‚ åœ¨å¤„ç†åŠ¨ä½œä¹‹åï¼Œå°†æ–°çŠ¶æ€å‘ˆç°ç»™ç”¨æˆ·ã€‚

å¦¥å¦¥çš„å•å‘æ•°æ®æµï¼

### ğŸ€„ï¸ state

ç®€å•çš„è¯´å°±æ˜¯ä¸€ä¸ª plain objectï¼Œå¿…é¡»é€šè¿‡ actions æ¥æ”¹å˜å®ƒã€‚

```js
const state = {
  count: 0
}
```

å› ä¸ºåœ¨æ›´æ–° state çš„æ—¶å€™æ‰§è¡Œçš„æ˜¯æµ…åˆå¹¶(shallow merge)ï¼Œæ‰€ä»¥é¡¶å±‚å¿…é¡»æ˜¯ plain object,è‡³äºå†…éƒ¨çš„ï¼Œéšä¾¿ä½ äº†ã€‚ Map? ğŸ‘Œ,Immutablejs? ğŸ‘Œ, Sets? ğŸ‘Œã€‚

Questionï¼šå¦‚æœé‡åˆ°åµŒå¥—çŠ¶æ€æ ‘(state can be a nested tree of objects)å¦‚ä½•ç ´â“

```js
const state = {
  counter: {
    count: 0
  }
}

// ä½ åªéœ€è¦è®©ä½ çš„ action å’Œå®ƒä¿æŒåŒæ ·çš„åµŒå¥—ç»“æ„å³å¯ï¼ˆåŒæ ·çš„å‘½åç©ºé—´ä¸‹ï¼‰
const actions = {
  counter: {
    down: value => state => ({ count: state.count - value }),
    up: value => state => ({ count: state.count + value })
  }
}
```

### ğŸ‘§ actions

åŒ Redux å¾ˆåƒã€‚

actions ä¹Ÿæ˜¯ä¸€ä¸ªè½½ä½“ï¼Œæ˜¯ä¸€ä¸ªä¸€å…ƒå‡½æ•°ï¼ˆåªæœ‰ä¸€ä¸ªå‚æ•°ï¼‰ï¼Œåªèƒ½é€šè¿‡ actions æ¥æ›´æ–°çŠ¶æ€ï¼Œè¿”å›ä¸€ä¸ªæµ…åˆå¹¶çš„æ–°çš„çŠ¶æ€ï¼Œç„¶å v-DOM ä¸€ç•ªæ“ä½œçŒ›å¦‚è™ä¹‹åè§†å›¾é‡ç»˜ã€‚

å½“ç„¶ä½ ä¹Ÿå¯ä»¥è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œå‚æ•°æ˜¯å½“å‰çš„ state å’Œ actions, ç„¶åå†è¿”å›ä¸€ä¸ªå±€éƒ¨çš„ state.

```js
const actions = {
  up: (value) => (state, actions) => ({count: state.count + value})
}
```
åŒ redux ä¸€æ ·ï¼ŒçŠ¶æ€çš„æ›´æ–°åº”è¯¥æ˜¯ immutable çš„ï¼Œå°±æ˜¯ä¸è¦åœ¨ actions ç›´æ¥æ”¹å˜ state, è€Œæ˜¯è¿”å›ä¸€ä¸ªæ–°çš„çŠ¶æ€ï¼Œè¿™å¯¹æ—¶é—´æ—…è¡Œè°ƒè¯•å¾ˆæœ‰ç”¨ï¼Œ
ä¹Ÿèƒ½é¿å…ä¸€äº›éš¾ä»¥è¿½è¸ªçš„å¼‚å¸¸ã€‚

#### ğŸŸ å¼‚æ­¥ actions

ç”¨äºå‰¯ä½œç”¨çš„æ“ä½œï¼ˆå†™å…¥æ•°æ®åº“ï¼Œå‘æœåŠ¡å™¨å‘é€è¯·æ±‚ç­‰ï¼‰ä¸éœ€è¦å…·æœ‰è¿”å›å€¼ã€‚ 

ä½ å¯ä»¥ä»å¦ä¸€ä¸ª action æˆ–å›è°ƒå‡½æ•°ä¸­è°ƒç”¨æ“ä½œã€‚ è¿”å› Promiseï¼Œundefined æˆ– null çš„æ“ä½œä¸ä¼šè§¦å‘é‡ç»˜æˆ–æ›´æ–°çŠ¶æ€ã€‚



### ğŸ’ view

## ğŸ react

ä¸ React åšä¸€ä¸ªç®€å•ç²—æš´çš„å¯¹æ¯”ï¼š

```jsx
import React from 'react'
import ReactDom from 'react-dom'
ReactDOM.render(<App />, document.getElementById('root'))


import { h, app } from 'hyperapp'
app(state, actions, view, document.getElementById('root'))
```

# âœˆï¸ è„šæ‰‹æ¶

è¿™æ˜¯ä¸€ä¸ªåŸºäº parcel + typescript + hyperapp + pwa çš„è„šæ‰‹æ¶, æ­£åœ¨è§†å›¾ä½¿å…¶æ”¯æŒ antdã€æ•°æ®æµã€è·¯ç”±ç­‰å¸¸è§„é…ç½®ã€‚

å¸Œæœ›æœ‰å…´è¶£çš„å¯ä»¥ PR

[æ–‡æ¡£](./about.md)